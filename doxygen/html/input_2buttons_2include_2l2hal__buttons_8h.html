<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STM32 level 2 HAL: /mnt/nfs/th/sps/fossa/Projects/Electronics/stm32-l2hal/l2hal/drivers/input/buttons/include/l2hal_buttons.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">STM32 level 2 HAL
   </div>
   <div id="projectbrief">Higher-level HAL over STM&#39;s one.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_746235237756e84cb4af536d89e8c160.html">l2hal</a></li><li class="navelem"><a class="el" href="dir_43a9fc447b703e43f1f662f322c73460.html">drivers</a></li><li class="navelem"><a class="el" href="dir_4835972030e9bf0cb53194a947456933.html">input</a></li><li class="navelem"><a class="el" href="dir_b997f7772bce57fcfd10da5929e7f512.html">buttons</a></li><li class="navelem"><a class="el" href="dir_1bae320cb3fc3bbf41caa416e1e35331.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">l2hal_buttons.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Polling buttons level 2 HAL driver.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stm32f1xx_hal.h&gt;</code><br />
<code>#include &lt;<a class="el" href="l2hal__aux_8h_source.html">l2hal_aux.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="l2hal__errors_8h_source.html">l2hal_errors.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for l2hal_buttons.h:</div>
<div class="dyncontent">
<div class="center"><img src="input_2buttons_2include_2l2hal__buttons_8h__incl.png" border="0" usemap="#_2mnt_2nfs_2th_2sps_2fossa_2_projects_2_electronics_2stm32-l2hal_2l2hal_2drivers_2input_2buttons_2include_2l2hal__buttons_8h" alt=""/></div>
<map name="_2mnt_2nfs_2th_2sps_2fossa_2_projects_2_electronics_2stm32-l2hal_2l2hal_2drivers_2input_2buttons_2include_2l2hal__buttons_8h" id="_2mnt_2nfs_2th_2sps_2fossa_2_projects_2_electronics_2stm32-l2hal_2l2hal_2drivers_2input_2buttons_2include_2l2hal__buttons_8h">
<area shape="rect" id="node3" href="l2hal__aux_8h.html" title="Auxiliary stuff for level 2 HAL. " alt="" coords="88,139,176,165"/>
<area shape="rect" id="node6" href="l2hal__errors_8h.html" title="Errors handling stuff for level 2 HAL. " alt="" coords="269,139,369,165"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="input_2buttons_2include_2l2hal__buttons_8h__dep__incl.png" border="0" usemap="#_2mnt_2nfs_2th_2sps_2fossa_2_projects_2_electronics_2stm32-l2hal_2l2hal_2drivers_2input_2buttons_2include_2l2hal__buttons_8hdep" alt=""/></div>
<map name="_2mnt_2nfs_2th_2sps_2fossa_2_projects_2_electronics_2stm32-l2hal_2l2hal_2drivers_2input_2buttons_2include_2l2hal__buttons_8hdep" id="_2mnt_2nfs_2th_2sps_2fossa_2_projects_2_electronics_2stm32-l2hal_2l2hal_2drivers_2input_2buttons_2include_2l2hal__buttons_8hdep">
<area shape="rect" id="node2" href="input_2buttons_2include_2l2hal__buttons__private_8h.html" title="Polling buttons level 2 HAL driver (private stuff). " alt="" coords="5,139,183,224"/>
</map>
</div>
</div>
<p><a href="input_2buttons_2include_2l2hal__buttons_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_l2_h_a_l___buttons___button_struct.html">L2HAL_Buttons_ButtonStruct</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_l2_h_a_l___buttons___context_struct.html">L2HAL_Buttons_ContextStruct</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3647fdc5b87d2b8e897dfb21941a4d3e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_2buttons_2include_2l2hal__buttons_8h.html#a3647fdc5b87d2b8e897dfb21941a4d3e">L2HAL_BUTTONS_MAX_PORTS_COUNT</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a3647fdc5b87d2b8e897dfb21941a4d3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7b61d8e7f6b0680d24bf8c088015d7f2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_2buttons_2include_2l2hal__buttons_8h.html#a7b61d8e7f6b0680d24bf8c088015d7f2">L2HAL_Buttons_Init</a> (<a class="el" href="struct_l2_h_a_l___buttons___context_struct.html">L2HAL_Buttons_ContextStruct</a> *context)</td></tr>
<tr class="separator:a7b61d8e7f6b0680d24bf8c088015d7f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea8071a71ee52eccd6192c11a3aa177f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_l2_h_a_l___buttons___button_struct.html">L2HAL_Buttons_ButtonStruct</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_2buttons_2include_2l2hal__buttons_8h.html#aea8071a71ee52eccd6192c11a3aa177f">L2HAL_Buttons_AddButton</a> (<a class="el" href="struct_l2_h_a_l___buttons___context_struct.html">L2HAL_Buttons_ContextStruct</a> *context, GPIO_TypeDef *port, uint16_t pin, void(*buttonEventsCallback)(void *, GPIO_PinState, uint16_t *))</td></tr>
<tr class="separator:aea8071a71ee52eccd6192c11a3aa177f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d7b2ced2ca7e92ed2442bda4318476b"><td class="memItemLeft" align="right" valign="top">GPIO_PinState&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_2buttons_2include_2l2hal__buttons_8h.html#a4d7b2ced2ca7e92ed2442bda4318476b">L2HAL_Buttons_GetButtonState</a> (<a class="el" href="struct_l2_h_a_l___buttons___button_struct.html">L2HAL_Buttons_ButtonStruct</a> *button, uint16_t *portsData)</td></tr>
<tr class="separator:a4d7b2ced2ca7e92ed2442bda4318476b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a501b0159a08e0b8aafab56d024033445"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_2buttons_2include_2l2hal__buttons_8h.html#a501b0159a08e0b8aafab56d024033445">L2HAL_Buttons_Poll</a> (<a class="el" href="struct_l2_h_a_l___buttons___context_struct.html">L2HAL_Buttons_ContextStruct</a> *context)</td></tr>
<tr class="separator:a501b0159a08e0b8aafab56d024033445"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Polling buttons level 2 HAL driver. </p>
<p>Driver for unlimited amount of buttons (polling, don't use interrupts).</p>
<p>How to use it:</p>
<p>1) Declare driver context (<a class="el" href="l2hal__custom_8h.html">l2hal_custom.h</a> is good place for it): <a class="el" href="struct_l2_h_a_l___buttons___context_struct.html">L2HAL_Buttons_ContextStruct</a> L2HAL_Buttons_Context;</p>
<p>2) Set up context: </p><pre class="fragment">L2HAL_Buttons_Context.SkipPinsInitialization = false;
</pre><p> L2HAL_Buttons_Context.CustomPinInitializer = NULL;</p>
<p>Read comments to <a class="el" href="struct_l2_h_a_l___buttons___context_struct.html">L2HAL_Buttons_ContextStruct</a> to know more about pins initialization.</p>
<p>3) Initialize driver:</p>
<p>L2HAL_Buttons_Init(&amp;L2HAL_Buttons_Context);</p>
<p>4) Declare button(s) event handler(s):</p>
<p>void Button1Callback(L2HAL_Buttons_ButtonStruct* button, GPIO_PinState newPinState, uint16_t* portData);</p>
<p>5) Add new button(s) to driver:</p>
<p>L2HAL_Buttons_AddButton(&amp;L2HAL_Buttons_Context, GPIOA, GPIO_PIN_0, &amp;Button1Callback);</p>
<p>6) Start to poll ports (in main loop or in interrupt):</p>
<p>while(true) { L2HAL_Buttons_Poll(&amp;L2HAL_Buttons_Context); } </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a3647fdc5b87d2b8e897dfb21941a4d3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3647fdc5b87d2b8e897dfb21941a4d3e">&#9670;&nbsp;</a></span>L2HAL_BUTTONS_MAX_PORTS_COUNT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define L2HAL_BUTTONS_MAX_PORTS_COUNT&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximal ports count for given device. A-D for STM32F103 </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aea8071a71ee52eccd6192c11a3aa177f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea8071a71ee52eccd6192c11a3aa177f">&#9670;&nbsp;</a></span>L2HAL_Buttons_AddButton()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_l2_h_a_l___buttons___button_struct.html">L2HAL_Buttons_ButtonStruct</a>* L2HAL_Buttons_AddButton </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_l2_h_a_l___buttons___context_struct.html">L2HAL_Buttons_ContextStruct</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GPIO_TypeDef *&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void *, GPIO_PinState, uint16_t *)&#160;</td>
          <td class="paramname"><em>buttonEventsCallback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Call this function to add new button. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>Pointer to driver context. </td></tr>
    <tr><td class="paramname">port</td><td>Pointer to port, to what button is attached. </td></tr>
    <tr><td class="paramname">pin</td><td>Pin, to what button is attached. </td></tr>
    <tr><td class="paramname">ButtonEventsCallback</td><td>Pointer to function, which will be called in case of button state change (aka handler). READ THE <a class="el" href="struct_l2_h_a_l___buttons___button_struct.html">L2HAL_Buttons_ButtonStruct</a> CAREFULLY to understand nature of the function parameters. @ </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4d7b2ced2ca7e92ed2442bda4318476b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d7b2ced2ca7e92ed2442bda4318476b">&#9670;&nbsp;</a></span>L2HAL_Buttons_GetButtonState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GPIO_PinState L2HAL_Buttons_GetButtonState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_l2_h_a_l___buttons___button_struct.html">L2HAL_Buttons_ButtonStruct</a> *&#160;</td>
          <td class="paramname"><em>button</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>portsData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets button state using data from ports. Usually you need to call this function from button events callback to determine together pressed buttons. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">button</td><td>Pointer to button, for what we want to determine state. </td></tr>
    <tr><td class="paramname">portsData</td><td>Pointer to ports data. Could be data from callback parameters or from context (if you need just to examine button state). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Button state. </dd></dl>

</div>
</div>
<a id="a7b61d8e7f6b0680d24bf8c088015d7f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b61d8e7f6b0680d24bf8c088015d7f2">&#9670;&nbsp;</a></span>L2HAL_Buttons_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void L2HAL_Buttons_Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_l2_h_a_l___buttons___context_struct.html">L2HAL_Buttons_ContextStruct</a> *&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Call this function to initialize driver. Feed it with pointer to driver context. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>Pointer to driver context. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a501b0159a08e0b8aafab56d024033445"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a501b0159a08e0b8aafab56d024033445">&#9670;&nbsp;</a></span>L2HAL_Buttons_Poll()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void L2HAL_Buttons_Poll </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_l2_h_a_l___buttons___context_struct.html">L2HAL_Buttons_ContextStruct</a> *&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Call this to poll ports and generate buttons events. Note, that if you call it from interrupt and buttons events handlers are still running, then function will block and wait until last handler completion. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>Pointer to driver context. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
